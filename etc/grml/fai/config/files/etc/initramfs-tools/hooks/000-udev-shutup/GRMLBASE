#!/bin/sh

# This file is installed by grml-live in 10-build-initramfs.
# It's purpose is to shut up so called "cosmetic warnings"
# introduced in udev 168-1.

PREREQ=""
prereqs()
{
	echo "$PREREQ"
}
case $1 in
prereqs)
	prereqs
	exit 0
	;;
esac

# Restrict this to the known problematic version.
UDEV_VERSION=$(dpkg-query -W -f '${Version}' udev)
if [ "$UDEV_VERSION" != "168-1" ]; then
	exit 0
fi

. /usr/share/initramfs-tools/hook-functions

TMPFILE=$(mktemp)

cat >$TMPFILE <<EOSH
#!/bin/sh
# THIS FILE IS AUTOMATICALLY GENERATED BY
# /etc/initramfs-tools/hooks/udev_shutup
exit 0
EOSH

chmod a+rx $TMPFILE

for i in cdrom_id net.agent mtd_probe; do
	if [ ! -e "${DESTDIR}"/lib/udev/$i ]; then
		cp -a $TMPFILE "${DESTDIR}"/lib/udev/$i
	fi
done

rm $TMPFILE

exit 0
