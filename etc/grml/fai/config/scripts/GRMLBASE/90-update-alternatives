#!/bin/bash
# Filename:      ${GRML_FAI_CONFIG}/config/scripts/GRMLBASE/90-update-alternatives
# Purpose:       set up /etc/alternatives/* according to grml preferences
# Authors:       grml-team (grml.org), (c) Michael Prokop <mika@grml.org>
# Bug-Reports:   see http://grml.org/bugs/
# License:       This file is licensed under the GPL v2 or any later version.
################################################################################

set -u
set -e

if [ -r $target/usr/bin/vim.basic ] ; then
  $ROOTCMD update-alternatives --set editor /usr/bin/vim.basic
  $ROOTCMD update-alternatives --set vi     /usr/bin/vim.basic
  $ROOTCMD update-alternatives --set vim    /usr/bin/vim.basic
  $ROOTCMD update-alternatives --set view   /usr/bin/vim.basic
fi

if [ -r $target/usr/bin/vim.gtk ] ; then
  $ROOTCMD update-alternatives --set editor /usr/bin/vim.gtk
  $ROOTCMD update-alternatives --set vi     /usr/bin/vim.gtk
  $ROOTCMD update-alternatives --set vim    /usr/bin/vim.gtk
  $ROOTCMD update-alternatives --set view   /usr/bin/vim.gtk
fi

if [ -r $target/usr/bin/uxterm ] ; then
  $ROOTCMD update-alternatives --set x-terminal-emulator /usr/bin/uxterm
elif [ -r $target/usr/bin/xterm ] ; then
  $ROOTCMD update-alternatives --set x-terminal-emulator /usr/bin/xterm
fi

if [ -r $target/etc/X11/cursors/whiteglass.theme ] ; then
  $ROOTCMD update-alternatives --set x-cursor-theme /etc/X11/cursors/whiteglass.theme
fi

if [ -r $target/usr/bin/iceweasel ] || [ -L $target/usr/bin/iceweasel ] ; then
  $ROOTCMD update-alternatives --set x-www-browser /usr/bin/iceweasel
fi

if [ -r $target/usr/bin/w3m ] ; then
  $ROOTCMD update-alternatives --set www-browser /usr/bin/w3m
fi

if [ -r $target/usr/bin/wm-ng ] ; then
  # activate wm-ng only if it is registered as x-window-manager:
  if $ROOTCMD update-alternatives --list x-window-manager | grep -q wm-ng ; then
    $ROOTCMD update-alternatives --set x-window-manager /usr/bin/wm-ng
  fi
fi

# sadly isn't available via update-alternates, anyway - use
# ntfs-3g (if available) as default for ntfs
if [ -r $target/sbin/mount.ntfs-3g ] || [ -L $target/sbin/mount.ntfs-3g ] ; then
  $ROOTCMD ln -sf /sbin/mount.ntfs-3g /sbin/mount.ntfs
fi

## END OF FILE #################################################################
# vim:ft=sh expandtab ai tw=80 tabstop=4 shiftwidth=2
